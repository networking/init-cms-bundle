/*! For license information please see index.min.js.LICENSE.txt */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t.MobileDragDrop=t.MobileDragDrop||{})}(this,(function(t){"use strict";function e(t){if(!y){var e=function(t){var e=t.target;do{if(!1!==e.draggable&&e.getAttribute&&"true"===e.getAttribute("draggable"))return e}while((e=e.parentNode)&&e!==document.body)}(t);if(e)try{y=new J(t,x,e,i)}catch(e){throw i(x,t,3),e}}}function i(t,e,i){if(0===i&&t.defaultActionOverride)try{t.defaultActionOverride(e),e.defaultPrevented}catch(t){}y=null}function s(t,e,i){void 0===i&&(i=!0),document.addEventListener(t,e,!!m&&{passive:i})}function n(t,e){document.removeEventListener(t,e)}function r(t){return 0===t.length?0:t.reduce((function(t,e){return e+t}),0)/t.length}function o(t){return t&&t.tagName}function h(t,e){for(var i=0;i<t.changedTouches.length;i++){if(t.changedTouches[i].identifier===e)return!0}return!1}function a(t,e,i){for(var s=[],n=[],o=0;o<e.touches.length;o++){var h=e.touches[o];s.push(h[t+"X"]),n.push(h[t+"Y"])}i.x=r(s),i.y=r(n)}function d(t,e){if(1===t.nodeType){for(var i=getComputedStyle(t),s=0;s<i.length;s++){var n=i[s];e.style.setProperty(n,i.getPropertyValue(n),i.getPropertyPriority(n))}e.style.pointerEvents="none",e.removeAttribute("id"),e.removeAttribute("class"),e.removeAttribute("draggable")}if(t.hasChildNodes())for(s=0;s<t.childNodes.length;s++)d(t.childNodes[s],e.childNodes[s])}function c(t){var e=t.cloneNode(!0);return d(t,e),e.style.position="absolute",e.style.left="0px",e.style.top="0px",e.style.zIndex="999999",e.classList.add(I),e.classList.add(T),e}function u(t,e,i,s,n){void 0===n&&(n=!0);var r=e.x,o=e.y;s&&(r+=s.x,o+=s.y),n&&(r-=parseInt(t.offsetWidth,10)/2,o-=parseInt(t.offsetHeight,10)/2);for(var h="translate3d("+r+"px,"+o+"px, 0)",a=0;a<L.length;a++){var d=L[a]+"transform";t.style[d]=h+" "+i[a]}}function f(t,e){return t?t===C[0]?O[0]:0===t.indexOf(C[1])||t===C[7]?O[1]:0===t.indexOf(C[4])?O[3]:t===C[6]?O[2]:O[1]:3===e.nodeType&&"A"===e.tagName?O[3]:O[1]}function l(t,e,i,s,n,r,o){if(void 0===r&&(r=!0),void 0===o&&(o=null),b){var h=E+"debug",a=E+"event-target",d=E+"event-related-target";e.classList.add(h),e.classList.add(a),o&&(o.classList.add(h),o.classList.add(d))}var c=function(t,e,i,s,n,r,o){void 0===o&&(o=null);var h=e.changedTouches[0],a=new Event(i,{bubbles:!0,cancelable:s});a.dataTransfer=r,a.relatedTarget=o,a.screenX=h.screenX,a.screenY=h.screenY,a.clientX=h.clientX,a.clientY=h.clientY,a.pageX=h.pageX,a.pageY=h.pageY;var d=t.getBoundingClientRect();return a.offsetX=a.clientX-d.left,a.offsetY=a.clientY-d.top,a}(e,i,t,r,document.defaultView,n,o),u=!e.dispatchEvent(c);return s.g=0,b&&(e.classList.remove(a),o&&o.classList.remove(d)),u}function p(t,e){if(!t||t===C[7])return e;if(e===O[1]){if(0===t.indexOf(O[1]))return O[1]}else if(e===O[3]){if(0===t.indexOf(O[3])||t.indexOf("Link")>-1)return O[3]}else if(e===O[2]&&(0===t.indexOf(O[2])||t.indexOf("Move")>-1))return O[2];return O[0]}function g(t){var i=t.target,s=function(){r.off(),o.off(),h.off(),clearTimeout(n)},n=setTimeout((function(){r.off(),o.off(),h.off(),e(t)}),x.holdToDrag),r=v(i,"touchend",s,this),o=v(i,"touchcancel",s,this),h=v(window,"scroll",s,this)}function v(t,e,i,s){return s&&(i=i.bind(s)),t.addEventListener(e,i),{off:function(){return t.removeEventListener(e,i)}}}var m,y,b=!1,x={iterationInterval:150},C=["none","copy","copyLink","copyMove","link","linkMove","move","all"],O=["none","copy","move","link"],L=["","-webkit-"],E="dnd-poly-",I=E+"drag-image",D=E+"snapback",T=E+"icon",J=function(){function t(t,e,i,n){this.h=t,this.i=e,this.j=i,this.k=n,this.l=0,this.m=null,this.o=null,this.p=t,this.q=t.changedTouches[0],this.s=this.t.bind(this),this.u=this.v.bind(this),s("touchmove",this.s,!1),s("touchend",this.u,!1),s("touchcancel",this.u,!1)}return t.prototype.A=function(){var t=this;this.l=1,this.B=O[0],this.C={D:{},F:void 0,g:3,G:[]},this.H={x:null,y:null},this.I={x:null,y:null};var e=this.j;if(this.J=new M(this.C,(function(i,s,n){e=i,"number"!=typeof s&&"number"!=typeof n||(t.K={x:s||0,y:n||0})})),this.C.g=2,this.J.dropEffect=O[0],l("dragstart",this.j,this.p,this.C,this.J))return this.l=3,this.L(),!1;if(a("page",this.p,this.I),this.M=c(e),this.N=function(t){return L.map((function(e){var i=t.style[e+"transform"];return i&&"none"!==i?i.replace(/translate\(\D*\d+[^,]*,\D*\d+[^,]*\)\s*/g,""):""}))}(this.M),!this.K)if(this.i.dragImageOffset)this.K={x:this.i.dragImageOffset.x,y:this.i.dragImageOffset.y};else if(this.i.dragImageCenterOnTouch){var i=getComputedStyle(e);this.K={x:0-parseInt(i.marginLeft,10),y:0-parseInt(i.marginTop,10)}}else{var s=e.getBoundingClientRect();i=getComputedStyle(e);this.K={x:s.left-this.q.clientX-parseInt(i.marginLeft,10)+s.width/2,y:s.top-this.q.clientY-parseInt(i.marginTop,10)+s.height/2}}return u(this.M,this.I,this.N,this.K,this.i.dragImageCenterOnTouch),document.body.appendChild(this.M),this.O=setInterval((function(){t.P||(t.P=!0,t.R(),t.P=!1)}),this.i.iterationInterval),!0},t.prototype.L=function(){this.O&&(clearInterval(this.O),this.O=null),n("touchmove",this.s),n("touchend",this.u),n("touchcancel",this.u),this.M&&(this.M.parentNode.removeChild(this.M),this.M=null),this.k(this.i,this.p,this.l)},t.prototype.t=function(t){var e=this;if(!1!==h(t,this.q.identifier)){if(this.p=t,0===this.l){var i=void 0;if(this.i.dragStartConditionOverride)try{i=this.i.dragStartConditionOverride(t)}catch(t){i=!1}else i=1===t.touches.length;return i?void(!0===this.A()&&(this.h.preventDefault(),t.preventDefault())):void this.L()}if(t.preventDefault(),a("client",t,this.H),a("page",t,this.I),this.i.dragImageTranslateOverride)try{var s=!1;if(this.i.dragImageTranslateOverride(t,{x:this.H.x,y:this.H.y},this.m,(function(t,i){e.M&&(s=!0,e.H.x+=t,e.H.y+=i,e.I.x+=t,e.I.y+=i,u(e.M,e.I,e.N,e.K,e.i.dragImageCenterOnTouch))})),s)return}catch(t){}u(this.M,this.I,this.N,this.K,this.i.dragImageCenterOnTouch)}},t.prototype.v=function(t){if(!1!==h(t,this.q.identifier)){if(this.i.dragImageTranslateOverride)try{this.i.dragImageTranslateOverride(void 0,void 0,void 0,(function(){}))}catch(t){}if(0===this.l)return void this.L();t.preventDefault(),this.l="touchcancel"===t.type?3:2}},t.prototype.R=function(){var t=this;if(b)var e=E+"debug",i=E+"immediate-user-selection",s=E+"current-drop-target";var n=this.B;this.C.g=3,this.J.dropEffect=O[0];var r=l("drag",this.j,this.p,this.C,this.J);if(r&&(this.B=O[0]),r||2===this.l||3===this.l)return this.S(this.l)?void function(t,e,i,s){var n=getComputedStyle(t);if("hidden"!==n.visibility&&"none"!==n.display){e.classList.add(D);var r=getComputedStyle(e),o=parseFloat(r.transitionDuration);if(isNaN(o)||0===o)s();else{var h=t.getBoundingClientRect(),a={x:h.left,y:h.top};a.x+=document.body.scrollLeft||document.documentElement.scrollLeft,a.y+=document.body.scrollTop||document.documentElement.scrollTop,a.x-=parseInt(n.marginLeft,10),a.y-=parseInt(n.marginTop,10);var d=parseFloat(r.transitionDelay),c=Math.round(1e3*(o+d));u(e,a,i,void 0,!1),setTimeout(s,c)}}else s()}(this.j,this.M,this.N,(function(){t.T()})):void this.T();var h=document.elementFromPoint(this.H.x,this.H.y),a=this.o;h!==this.m&&h!==this.o&&(b&&(this.m&&this.m.classList.remove(i),h&&(h.classList.add(e),h.classList.add(i))),this.m=h,null!==this.o&&(this.C.g=3,this.J.dropEffect=O[0],l("dragexit",this.o,this.p,this.C,this.J,!1)),null===this.m?this.o=this.m:(this.C.g=3,this.J.dropEffect=f(this.C.F,this.j),l("dragenter",this.m,this.p,this.C,this.J)?(this.o=this.m,this.B=p(this.J.effectAllowed,this.J.dropEffect)):this.m!==document.body&&(this.o=document.body))),a!==this.o&&o(a)&&(b&&a.classList.remove(s),this.C.g=3,this.J.dropEffect=O[0],l("dragleave",a,this.p,this.C,this.J,!1,this.o)),o(this.o)&&(b&&(this.o.classList.add(e),this.o.classList.add(s)),this.C.g=3,this.J.dropEffect=f(this.C.F,this.j),!1===l("dragover",this.o,this.p,this.C,this.J)?this.B=O[0]:this.B=p(this.J.effectAllowed,this.J.dropEffect)),n!==this.B&&this.M.classList.remove(E+n);var d=E+this.B;!1===this.M.classList.contains(d)&&this.M.classList.add(d)},t.prototype.S=function(t){if(b){var e=E+"immediate-user-selection",i=E+"current-drop-target";this.o&&this.o.classList.remove(i),this.m&&this.m.classList.remove(e)}var s=this.B===O[0]||null===this.o||3===t;return s?o(this.o)&&(this.C.g=3,this.J.dropEffect=O[0],l("dragleave",this.o,this.p,this.C,this.J,!1)):o(this.o)&&(this.C.g=1,this.J.dropEffect=this.B,!0===l("drop",this.o,this.p,this.C,this.J)?this.B=this.J.dropEffect:this.B=O[0]),s},t.prototype.T=function(){this.C.g=3,this.J.dropEffect=this.B,l("dragend",this.j,this.p,this.C,this.J,!1),this.l=2,this.L()},t}(),M=function(){function t(t,e){this.U=t,this.V=e,this.W=O[0]}return Object.defineProperty(t.prototype,"types",{get:function(){if(0!==this.U.g)return Object.freeze(this.U.G)},enumerable:!0,configurable:!0}),t.prototype.setData=function(t,e){if(2===this.U.g){if(t.indexOf(" ")>-1)throw new Error("illegal arg: type contains space");this.U.D[t]=e,-1===this.U.G.indexOf(t)&&this.U.G.push(t)}},t.prototype.getData=function(t){if(1===this.U.g||2===this.U.g)return this.U.D[t]||""},t.prototype.clearData=function(t){if(2===this.U.g){if(t&&this.U.D[t]){delete this.U.D[t];var e=this.U.G.indexOf(t);return void(e>-1&&this.U.G.splice(e,1))}this.U.D={},this.U.G=[]}},t.prototype.setDragImage=function(t,e,i){2===this.U.g&&this.V(t,e,i)},Object.defineProperty(t.prototype,"effectAllowed",{get:function(){return this.U.F},set:function(t){2===this.U.g&&C.indexOf(t)>-1&&(this.U.F=t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dropEffect",{get:function(){return this.W},set:function(t){0!==this.U.g&&C.indexOf(t)>-1&&(this.W=t)},enumerable:!0,configurable:!0}),t}();t.polyfill=function(t){if(t&&Object.keys(t).forEach((function(e){x[e]=t[e]})),!x.forceApply){var i=function(){var t={dragEvents:"ondragstart"in document.documentElement,draggable:"draggable"in document.documentElement,touchEvents:"ontouchstart"in document.documentElement,userAgentSupportingNativeDnD:void 0},e=!!window.chrome||/chrome/i.test(navigator.userAgent);return t.userAgentSupportingNativeDnD=!(/iPad|iPhone|iPod|Android/.test(navigator.userAgent)||e&&t.touchEvents),b&&Object.keys(t).forEach((function(t){})),t}();if(i.userAgentSupportingNativeDnD&&i.draggable&&i.dragEvents)return!1}return m=function(){var t=!1;try{var e=Object.defineProperty({},"passive",{get:function(){t=!0}});window.addEventListener("test",null,e)}catch(t){}return t}(),x.holdToDrag?s("touchstart",g,!1):s("touchstart",e,!1),!0},Object.defineProperty(t,"__esModule",{value:!0})}));