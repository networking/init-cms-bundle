/*! For license information please see mediaAdmin.24eff5e0.js.LICENSE.txt */
(()=>{"use strict";var e,t={8266(e,t,a){a.d(t,{x:()=>c});var o=a(443),r=a(709),i=a(3621),n=a(1228),s=a(5022),l=a(6467),d=(a(5458),a(4692));window.axiosConfig={headers:{"X-Requested-With":"XMLHttpRequest"}},d.fn.select2.defaults.set("theme","bootstrap5"),d.fn.select2.defaults.set("width","100%"),d.fn.select2.defaults.set("selectionCssClass",":all:");const c={listDialog:null,routing:null,translations:null,collectionCounters:[],debug:!1,async getTranslator(){return this.translations||(this.translations=l.e.load()),this.translations},async init(e){this.debug=e,this.translations=await this.getTranslator(),r.A.init(),o.A.init(),i.A.init(),n.A.init(),this.initLinkDialogs(),this.initializeDatePickers(),this.initializeDateTimePickers(),this.initSelect2(),this.initCkeditor(),this.initCollectionType(),this.initTabs()},initTabs(e){e??=document.body;[].slice.call(document.querySelectorAll('[data-kt-tabs="true"]')).forEach(t=>{if("1"===t.getAttribute("data-kt-initialized"))return;const a=e.querySelector(`a[href="${t.dataset.activeTab}"]`),o=new bootstrap.Tab(a),r=t.dataset.tabField;o.show();const i=document.querySelectorAll('a[data-bs-toggle="tab"]'),n=document.querySelector(r);i.forEach(e=>{e.addEventListener("shown.bs.tab",e=>{n.value=e.target.dataset.tabIndex})})})},initToolTips(e){e??=document.body;[].slice.call(e.querySelectorAll('[data-bs-toggle="tooltip"]')).map(e=>new bootstrap.Tooltip(e))},initLinkDialogs(){KTUtil.on(document.body,".dialog-link","click",e=>{this.createLinkDialog(e)})},createLinkDialog(e){e.preventDefault(),e.stopPropagation(),this.initializeDialog();let t=e.target;t.getAttribute("href")||(t=t.closest("a")),fetch(t.getAttribute("href"),{method:"GET",headers:{"X-Requested-With":"XMLHttpRequest"}}).then(e=>e.text()).then(e=>{document.querySelector("#list_dialog").querySelector(".modal-content").innerHTML=e,this.listDialog.show()})},initializeDialog(){this.listDialog||(this.listDialog=new bootstrap.Modal(document.querySelector("#list_dialog",{height:"auto",width:650,show:!1})))},initializeDatePickers(){document.querySelectorAll('[data-provider="datepicker"]').forEach(e=>{const t=e.dataset.dateFormat,a=e.dataset.dateLanguage;flatpickr(e,{dateFormat:t,locale:a,allowInput:!0})})},initializeDateTimePickers(){document.querySelectorAll('[data-provider="datetimepicker"]').forEach(e=>{const t=e.dataset.dateFormat,a=e.dataset.dateLanguage;flatpickr(e,{dateFormat:t,locale:a,enableTime:!0,allowInput:!0,time_24hr:!0})})},initSelect2(){[].slice.call(document.querySelectorAll('[data-control="select2"], [data-kt-select2="true"]')).forEach(e=>{if("1"===e.getAttribute("data-kt-initialized"))return;const t=d(`#${e.id}`),a=t.parent();t.select2({dropdownParent:a}).on("select2:select",e=>{const t=new Event("change",{bubbles:!0});e.target.dispatchEvent(t)}),e.setAttribute("data-kt-initialized","1")})},initCkeditor(){[].slice.call(document.querySelectorAll('[data-control="ckeditor"], [data-kt-ckeditor="true"]')).forEach(e=>{if("1"===e.getAttribute("data-kt-initialized"))return;const t=e.getAttribute("id"),a=JSON.parse(e.dataset.config),o=JSON.parse(e.dataset.plugins),r=JSON.parse(e.dataset.templates),i=JSON.parse(e.dataset.styles);JSON.parse(e.dataset.filebrowser),CKEDITOR.instances[t]&&(CKEDITOR.instances[t].destroy(!0),delete CKEDITOR.instances[t]);for(const[e,t]of Object.entries(o))CKEDITOR.plugins.addExternal(e,t.path,t.filename);for(const[e,t]of Object.entries(i))null===CKEDITOR.stylesSet.get(e)&&CKEDITOR.stylesSet.add(e,t);for(const[e,t]of Object.entries(r))CKEDITOR.addTemplates(e,t);const n={};for(const[e,t]of Object.entries(a))"filebrowserBrowseRoute"!==e?"filebrowserImageBrowseRoute"!==e?"filebrowserUploadRoute"!==e?"filebrowserImageUploadRoute"!==e?"filebrowserBrowseRouteParameters"!==e&&"filebrowserImageBrowseRouteParameters"!==e&&"filebrowserUploadRouteParameters"!==e&&"filebrowserImageUploadRouteParameters"!==e&&(n[e]=t):n.filebrowserImageUploadUrl=CMSRouting.generate(t,a.filebrowserImageUploadRouteParameters):n.filebrowserUploadUrl=CMSRouting.generate(t,a.filebrowserUploadRouteParameters):n.filebrowserImageBrowseUrl=CMSRouting.generate(t,a.filebrowserImageBrowseRouteParameters):n.filebrowserBrowseUrl=CMSRouting.generate(t,a.filebrowserBrowseRouteParameters);CKEDITOR.disableAutoInline=!0;CKEDITOR.replace(t,n).on("change",t=>{e.value=t.editor.getData()}),e.setAttribute("data-kt-initialized","1")})},initCollectionType(){document.querySelectorAll("[data-collection-list]").forEach(e=>{this.setupCollectionType(e)})},setupCollectionType(e){e.dataset.cmsCollectionType||(s.A.init(),KTUtil.on(e,"[data-collection-add-btn]","click",e=>{e.preventDefault();let t=e.target;t.classList.contains("btn")||(t=t.closest(".btn"));let a=0;const o=t.dataset.collectionAddBtn,r=document.querySelector(`#${o}`),i=[...document.querySelectorAll(`div[id^="${r.id}_"]`)].pop();i&&(a=parseInt(i.id.replace(`${r.id}_`,"")),a+=1);let n=r.dataset.prototype;const s=r.dataset.prototypeName||"__name__",l=new RegExp(`${r.id}_${s}`,"g");n=n.replace(l,`${r.id}_${a}`);const d=r.id.split("_"),u=new RegExp(`${d[d.length-1]}\\]\\[${s}`,"g");n=n.replace(u,`${d[d.length-1]}][${a}`),r.insertAdjacentHTML("beforeend",n),t.dispatchEvent(new CustomEvent("afterAddItem",{bubbles:!0,detail:{proto:n,counter:a}})),c.initSpecialFields()}),KTUtil.on(e,"[data-collection-remove-btn]","click",e=>{e.preventDefault();let t=e.target;t.classList.contains("btn")||(t=t.closest(".btn")),t.closest(".collection-item").remove(),t.dispatchEvent(new CustomEvent("afterRemoveItem",{bubbles:!0}))}),e.dataset.cmsCollectionType=1)},initSpecialFields(){r.A.init(),o.A.init(),i.A.init(),this.initializeDatePickers(),this.initializeDateTimePickers(),this.createSelect2(),this.initCkeditor(),this.initCollectionType()},log(...e){if(!this.debug)return;const t=`[Init CMS] ${Array.prototype.join.call(e,", ")}`;window.console?.log?window.console.log(t):window.opera?.postError&&window.opera.postError(t)},error(...e){if(!this.debug)return;const t=`[Init CMS] ${Array.prototype.join.call(e,", ")}`;window.console?.error?window.console.error(t):window.opera?.postError&&window.opera.postError(t)},createInitCmsMessageBox(e,t,a=2e3,o="toastr-top-right"){toastr.options={closeButton:!0,debug:!1,newestOnTop:!0,progressBar:!1,positionClass:o,preventDuplicates:!0,onclick:null,showDuration:"2000",hideDuration:"1000",timeOut:a,extendedTimeOut:"1000",showEasing:"linear",hideEasing:"linear",showMethod:"fadeIn",hideMethod:"fadeOut"},"success"===e?toastr.success(t):"warning"===e?toastr.warning(t):"error"===e||"danger"===e?toastr.error(t):toastr.info(t)},createSelect2(){[].slice.call(document.querySelectorAll('[data-control="select2"], [data-kt-select2="true"]')).forEach(e=>{if("1"===e.getAttribute("data-kt-initialized"))return;const t={dir:document.body.getAttribute("direction")};if(e.closest(".modal")&&(t.dropdownParent=e.closest(".modal")),"true"===e.getAttribute("data-hide-search")&&(t.minimumResultsForSearch=1/0),d(e).select2(t),d(e).on("select2:select",()=>{const t=new Event("change",{bubbles:!0});e.dispatchEvent(t)}),e.hasAttribute("data-dropdown-parent")&&e.hasAttribute("multiple")){const t=document.querySelector(e.getAttribute("data-dropdown-parent"));if(t?.hasAttribute("data-kt-menu")){const a=new KTMenu(t);a&&(d(e).on("select2:unselect",()=>{e.setAttribute("data-multiple-unselect","1")}),a.on("kt.menu.dropdown.hide",()=>{if("1"===e.getAttribute("data-multiple-unselect"))return e.removeAttribute("data-multiple-unselect"),!1}))}}e.setAttribute("data-kt-initialized","1")})}};a.g.CMSAdmin=c,window.CMSAdmin=c},7331(e,t,a){var o=a(8266),r=(a(1460),a(6128)),i=a.n(r),n=a(4692),s=a(4692);const l=(()=>{let e,t,a=null,r=[],l=!0,d=!0,c="";const u=()=>{e||(t=document.querySelector("#tag_dialog"),e=new bootstrap.Modal(t,{height:"auto",width:650,show:!1}))},p=a=>{a.preventDefault();const r=a.target;axios.post(r.action,new FormData(r),axiosConfig).then(a=>{"application/json"===a.headers["content-type"]&&"ok"===a.data.result&&(e.hide(),o.x.createInitCmsMessageBox(a.data.status,a.data.message),y(a.data.json,a.data.objectId)),t.querySelector(".modal-content").innerHTML=a.data,t.querySelector("form").addEventListener("submit",p),o.x.initSpecialFields()}).catch(e=>{console.log(e)})},h=()=>{CMSApp.create_xeditable(".tag_link",{toggle:"manual",url:c,name:"name",display:function(e,t){const a=n(".jstree-icon",this);void 0!==t&&n(this).html(a).append(e)}},(e,t)=>{g(t.newValue,t.response.objectId)},(e,t)=>{if("save"===t){const e=new URL(window.location.href),t=e.searchParams;t.set("time",s.now()),e.search=t.toString(),history.replaceState({time:s.now()},"updated",e.toString())}})},g=(e,t)=>{var o=n(a).jstree(!0).get_json();m(o,e,t,o.length-1),f()},m=(e,t,a,o)=>{if(o<0)return e;var r=e[o];return void 0!==r.data&&r.data.id===a&&(r.text=t,r.li_attr["data-tag-name"]=t),r.children.length>0&&m(r.children,t,a,r.children.length-1),m(e,t,a,o-1)},f=()=>{const e=["sort","types","unique"];l&&e.push("dnd"),d&&e.push("delete");const t=n(a);r=t.data("tagsJson"),c=t.data("inlineEditUrl"),t.jstree({types:{default:{icon:"fa fa-folder text-primary fs-2x"},file:{icon:"fa fa-file text-primary fs-2x"}},plugins:e,dnd:{check_while_dragging:!0,is_draggable:e=>"show_all_media"!==e[0].a_attr.class},sort:function(e,t){const a=this.get_node(e),o=this.get_node(t);return a.data.show_first?-1:o.data.show_first||a.text.toLowerCase()>o.text.toLowerCase()?1:-1},core:{themes:{variant:"large"},check_callback:(e,t,a)=>"move_node"!==e||!a.a_attr||"show_all_media"!==a.a_attr.class,data:(e,t)=>{t(r)}}}),t.on("refresh.jstree",()=>{h()}).on("move_node.jstree",(e,t)=>{const a=t.new_instance.get_json();var o=w(a,0,0,a.length-1,[]);b(o),h()}).on("after_open.jstree",()=>{h()}).on("redraw.jstree",()=>{h()})},b=e=>{axios.post(a.dataset.updateTreeUrl,{nodes:e},axiosConfig).then(e=>{var t=e.data;o.x.createInitCmsMessageBox(t.status,t.message);const a=new URL(window.location.href),r=a.searchParams;r.set("time",s.now()),a.search=r.toString(),history.replaceState({time:s.now()},"updated",a.toString())})},w=(e,t,a,o,r)=>{if(o<0)return r;var i=e[o];return i.children.length>0&&r.push.apply(w(i.children,i.data.id,a+1,i.children.length-1,r)),r.push({id:i.data.id,parent_id:t,name:i.text,depth:a}),w(e,t,a,o-1,r)},y=(e,t)=>{r=e,n(a).jstree(!0).refresh()},v=e=>{e||(e=[]);const t=new FormData(document.querySelector("#search-form"));for(const a in e)t.append(a,e[a]);e=Object.fromEntries(t.entries()),axios.get(a.dataset.refreshListUrl,{...axiosConfig,params:e}).then(e=>{n("#item_list").html(e.data),n("html, body").animate({scrollTop:n("#item_list").scrollTop()},"slow"),_(),KTComponents.init()})},_=()=>{i()({touchNavigation:!0,loop:!0,autoplayVideos:!0,selector:".light-box-items"})};return{init:()=>{a=document.querySelector("#tagsContainer"),l=a.dataset.canSort,d=a.dataset.canDelete,f(),u(),_(),KTUtil.on(document.body,"a.delete_check_box","click",e=>{e.preventDefault();let t=!1;const a=document.querySelector(".batch-actions");if(document.querySelectorAll(".delete_check_box").forEach(e=>{e.checked?(e.classList.add("ui-selected"),t=!0):e.classList.remove("ui-selected")}),t)return a.classList.remove("d-none");a.classList.add("d-none")}),KTUtil.on(document.body,"a.batch","click",e=>{e.preventDefault(),document.querySelector("input[name='action']").value=e.target.dataset.value,createBatchDialog(e)}),KTUtil.on(document.body,"a.tag-dialog-link","click",a=>{a.preventDefault(),(a=>{a.preventDefault(),a.stopPropagation(),u();let o=a.target;o.getAttribute("href")||(o=o.closest("a")),fetch(o.getAttribute("href"),{method:"GET",headers:{"X-Requested-With":"XMLHttpRequest"}}).then(e=>e.text()).then(a=>{document.querySelector("#tag_dialog").querySelector(".modal-content").innerHTML=a,e.show(),t.querySelector("form").addEventListener("submit",p)})})(a)}),KTUtil.on(document.body,".tag_link","click",(e,t)=>{e.preventDefault();var a=e.target.dataset.pk;void 0===t&&v({"filter[tags][value]":a})}),KTUtil.on(document.body,".show_all_media","click",(e,t)=>{e.preventDefault(),v({"filter[_page]":1,"filter[tags][value]":""})}),KTUtil.on(document.body,"a.media-pager","click",e=>{e.preventDefault();let t=e.target;t.getAttribute("href")||(t=t.closest("a"));const a=t.dataset.page,o=t.dataset.sortOrder,r=t.dataset.sortBy,i=t.dataset.perPage,n=t.dataset.tags,s=t.dataset.name;v({"filter[_page]":a,"filter[_sort_order]":o,"filter[_sort_by]":r,"filter[_per_page]":i,"filter[tags][value]":n,"filter[name][value]":s})}),KTUtil.on(document.body,".per-page","change",e=>{e.preventDefault();const t=e.target.value,a=e.target.dataset.page,o=e.target.dataset.sortOrder,r=e.target.dataset.sortBy,i=e.target.dataset.tags,n=e.target.dataset.name;v({"filter[_per_page]":t,"filter[_page]":a,"filter[_sort_order]":o,"filter[_sort_by]":r,"filter[tags][value]":i,"filter[name][value]":n})})},refreshList:e=>{v(e)}}})();class d{constructor(e){this.element=e,this.context=this.element.dataset.context,this.provider=this.element.dataset.provider,this.uploadForm=this.element.querySelector("#upload-form");const t=this.element.dataset.uniqueId,a=this.element.querySelector(".dropzone-item");a.id="";const o=a.parentNode.innerHTML;a.parentNode.removeChild(a);const r=this,i=new Dropzone(this.element,{init:function(){this.on("success",(e,t)=>{r.changeButtonRow(e,t),l.refreshList()}),this.on("error",(e,t)=>{t.duplicate&&r.changeButtonRow(e,t)})},url:this.uploadForm.action,params:{context:this.context,provider:this.provider,oneuploader:!0},thumbnailWidth:80,thumbnailHeight:80,parallelUploads:20,previewTemplate:o,previewsContainer:"#previews",clickable:".fileinput-zone"});i.on("totaluploadprogress",e=>{document.querySelector("#total-progress .progress-bar").style.width=e+"%"}),i.on("sending",(e,a,o)=>{const r=document.querySelector("#"+t+"_tags").value;o.append("tags",r),document.querySelector("#total-progress").style.opacity="1"}),i.on("queuecomplete",e=>{document.querySelector("#total-progress").style.opacity="0"}),document.querySelector("#actions .cancel").onclick=()=>{i.removeAllFiles(!0)}}changeButtonRow(e,t){const a=e.previewElement.querySelector("[data-dz-url]");a.href=t.url,a.classList.remove("d-none"),e.previewElement.querySelector(".progress").classList.add("d-none")}}(e=>{var t=document.createElement("a");t.className="delete-tag dialog-link float-end ",t.innerHTML='<i class="la la-trash fs-2 mx-3"></i>',e.jstree.defaults.delete=e.noop,e.jstree.plugins.delete=function(a,o){this.teardown=function(){this.settings.delete&&this.element.find(".delete-tag").remove(),o.teardown.call(this)},this.redraw_node=function(a,r,i,n){if(a=o.redraw_node.call(this,a,r,i,n),this.get_node(a).children?.length)return a;const s=t.cloneNode(!0),l=this.get_node(a);return a&&e(a).hasClass("sortable-tag")&&(s.href=l.data.delete_link,a.insertBefore(s,a.childNodes[2])),a}}})(n),KTUtil.onDOMContentLoaded(()=>{l.init(),document.body.addEventListener("shown.bs.modal",e=>{const t=e.target.querySelector("#dropzone_area");t&&new d(t)})})}},a={};function o(e){var r=a[e];if(void 0!==r)return r.exports;if(void 0===t[e]){var i=new Error("Cannot find module '"+e+"'");throw i.code="MODULE_NOT_FOUND",i}var n=a[e]={exports:{}};return t[e].call(n.exports,n,n.exports,o),n.exports}o.m=t,e=[],o.O=(t,a,r,i)=>{if(!a){var n=1/0;for(c=0;c<e.length;c++){for(var[a,r,i]=e[c],s=!0,l=0;l<a.length;l++)(!1&i||n>=i)&&Object.keys(o.O).every(e=>o.O[e](a[l]))?a.splice(l--,1):(s=!1,i<n&&(n=i));if(s){e.splice(c--,1);var d=r();void 0!==d&&(t=d)}}return t}i=i||0;for(var c=e.length;c>0&&e[c-1][2]>i;c--)e[c]=e[c-1];e[c]=[a,r,i]},o.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return o.d(t,{a:t}),t},o.d=(e,t)=>{for(var a in t)o.o(t,a)&&!o.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},o.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),o.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e={790:0,867:0};o.O.j=t=>0===e[t];var t=(t,a)=>{var r,i,[n,s,l]=a,d=0;if(n.some(t=>0!==e[t])){for(r in s)o.o(s,r)&&(o.m[r]=s[r]);if(l)var c=l(o)}for(t&&t(a);d<n.length;d++)i=n[d],o.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return o.O(c)},a=self.webpackChunkinit_cms_bundle=self.webpackChunkinit_cms_bundle||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))})();var r=o.O(void 0,[460,195,692,128,409],()=>o(7331));r=o.O(r)})();
//# sourceMappingURL=mediaAdmin.24eff5e0.js.map