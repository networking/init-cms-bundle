{"version":3,"file":"imageEditor.7a63e584.css","mappings":";;;AACA,gBACI,iBACJ,CAEA,OAII,0BAA2B,CAF3B,aAAc,CADd,SAIJ,CAEA,eAJI,mBAaJ,CATA,QAKI,QAAS,CAHT,SAAU,CACV,iBAAkB,CAKlB,iBAAkB,CAJlB,OAAQ,CAER,8BAAgC,CAChC,kCAEJ,CAEA,6BACI,UACJ,CAEA,8BACI,SACJ,C","sources":["webpack://init-cms-bundle/./assets/js/components/Editor.vue"],"sourcesContent":["<style>\n.imageContainer {\n    position: relative;\n}\n\n.image {\n    opacity: 1;\n    display: block;\n    transition: .5s ease;\n    backface-visibility: hidden;\n}\n\n.middle {\n    transition: .5s ease;\n    opacity: 0;\n    position: absolute;\n    top: 50%;\n    left: 50%;\n    transform: translate(-50%, -50%);\n    -ms-transform: translate(-50%, -50%);\n    text-align: center;\n}\n\n.imageContainer:hover .image {\n    opacity: 0.3;\n}\n\n.imageContainer:hover .middle {\n    opacity: 1;\n}\n</style>\n<template>\n    <div class=\"imageEditorApp py-10\">\n        <div class=\"imageContainer d-flex justify-content-center align-items-center\">\n<!--            <img :src=\"imageURL\" class=\"img-responsive image\" @contextmenu.prevent=\"$refs.menu.open\">-->\n            <img :src=\"imageURL\" class=\"img-fluid center-block image\" alt=\"Bild bearbeiten\">\n            <div class=\"middle\">\n                <div class=\"text\"><a href=\"\" class=\"btn btn-default\" @click.prevent=\"editImage\"><i class=\"fa fa-magic fa-small\"></i> {{ $t('edit_image')}}</a></div>\n            </div>\n        </div>\n        <div class=\"alert mt-10\" :class=\"[alertType === 'error'?'alert-danger':'alert-success']\" v-if=\"alert\" role=\"alert\" v-html=\"alertMessage\"></div>\n        <div id=\"imageModal\" class=\"modal fade\" tabindex=\"-1\" role=\"dialog\">\n            <div class=\"modal-dialog  modal-fullscreen \" role=\"document\">\n                <div class=\"modal-content\">\n                    <div class=\"modal-header\">\n\n                        <h4 class=\"modal-title\">{{ $t('created_image') }}</h4>\n\n                        <!--begin::Close-->\n                        <div class=\"btn btn-icon btn-sm btn-active-light-primary ms-2\" data-bs-dismiss=\"modal\" aria-label=\"Close\">\n                            <i class=\"ki-outline ki-cross fs-1\"></i>\n                        </div>\n                    </div>\n                    <div class=\"modal-body align-center\">\n                        <div class=\"row\">\n                            <div class=\"col-md-6 align-center\">\n                                <h3>{{ $t('original_image') }}</h3>\n                                <p><img :src=\"imageURL\" class=\"img-fluid center-block\"/></p></div>\n                            <div class=\"col-md-6 align-center\">\n                                <h3>{{ $t('new_image') }}</h3>\n                                <p><img :src=\"newImage\" class=\"img-fluid center-block\"/></p></div>\n                        </div>\n                    </div>\n                    <div class=\"modal-footer\">\n                        <button type=\"button\" class=\"btn btn-sm btn-light\" data-bs-dismiss=\"modal\">{{ $t('cancel') }}</button>\n                        <button type=\"button\" class=\"btn btn-sm btn-warning\" @click.prevent=\"updateImage\">{{ $t('replace_image') }}</button>\n                        <button type=\"button\" class=\"btn btn-sm btn-primary\" @click.prevent=\"cloneImage\">{{ $t('create_new_image') }}</button>\n                    </div>\n                </div><!-- /.modal-content -->\n            </div><!-- /.modal-dialog -->\n        </div><!-- /.modal -->\n        <div id=\"confirmModal\" class=\"modal fade\" tabindex=\"-1\" role=\"dialog\">\n            <div class=\"modal-dialog\" role=\"document\">\n            <div class=\"modal-content\">\n                <div class=\"modal-header\">\n                    <h4 class=\"modal-title\">{{ $t('are_you_sure') }}</h4>\n                    <!--begin::Close-->\n                    <div class=\"btn btn-icon btn-sm btn-active-light-primary ms-2\" data-bs-dismiss=\"modal\" aria-label=\"Close\">\n                        <i class=\"ki-outline ki-cross fs-1\"></i>\n                    </div>\n                </div>\n                <div class=\"modal-body\">\n                    <p>\n                        {{ $t('message.cannot_be_undone') }}\n                        </p>\n                </div>\n                <div class=\"modal-footer\">\n                    <button type=\"button\" class=\"btn btn-sm btn-warning\" @click.prevent=\"confirmUpdate\">{{ $t('continue') }}</button>\n                    <button type=\"button\" class=\"btn btn-sm btn-light\" @click.prevent=\"rejectUpdate\">{{ $t('cancel') }}</button>\n                </div>\n            </div><!-- /.modal-content -->\n        </div><!-- /.modal-dialog -->\n        </div><!-- /.modal -->\n        <div id=\"editorModal\" class=\"modal fade\" tabindex=\"-1\" role=\"dialog\">\n            <div class=\"modal-dialog modal-fullscreen\" role=\"document\">\n                <div class=\"modal-content\">\n                    <div id=\"imageEditor\" class=\"h-100\"></div>\n                </div>\n            </div>\n        </div>\n    </div>\n\n</template>\n<script>\nimport axios from \"axios\"\nimport FilerobotImageEditor from \"filerobot-image-editor\"\n\nconst { TABS, TOOLS } = FilerobotImageEditor\nconst ALLOWED_FILE_EXTENTIONS = [\"gif\", \"jpg\", \"jpeg\", \"png\"]\nconst imageContainer = document.getElementById(\"image-container\")\nconst axiosConfig = { headers: { \"X-Requested-With\": \"XMLHttpRequest\" } }\nconst langauge = \"de\" //imageContainer.getAttribute('data-lang');\n\nexport default {\n\tname: \"Editor\",\n\tmounted() {\n\t\tthis.imageURL = imageContainer.getAttribute(\"data-image-src\")\n\t\tthis.id = imageContainer.getAttribute(\"data-image-id\")\n\t\tthis.context = imageContainer.getAttribute(\"data-image-context\")\n\t\tthis.provider = imageContainer.getAttribute(\"data-image-provider\")\n\t\tthis.fileExtension = this.imageURL.slice(\n\t\t\t((this.imageURL.lastIndexOf(\".\") - 1) >>> 0) + 2,\n\t\t)\n\n\t\tthis.imageModal = new bootstrap.Modal(\n\t\t\tdocument.getElementById(\"imageModal\"),\n\t\t\t{\n\t\t\t\tkeyboard: false,\n\t\t\t},\n\t\t)\n\n\t\tthis.confirmModal = new bootstrap.Modal(\n\t\t\tdocument.getElementById(\"confirmModal\"),\n\t\t\t{\n\t\t\t\tkeyboard: false,\n\t\t\t},\n\t\t)\n\n\t\tthis.editorModal = new bootstrap.Modal(\n\t\t\tdocument.getElementById(\"editorModal\"),\n\t\t\t{\n\t\t\t\tkeyboard: false,\n\t\t\t},\n\t\t)\n\t},\n\tdata() {\n\t\tthis.$i18n.locale = langauge\n\t\treturn {\n\t\t\tlocale: langauge,\n\t\t\timageURL: \"\",\n\t\t\tid: \"\",\n\t\t\tcontext: \"\",\n\t\t\tprovider: \"\",\n\t\t\timageEditor: \"\",\n\t\t\tnewImage: \"\",\n\t\t\talert: false,\n\t\t\talertMessage: false,\n\t\t\talertType: false,\n\t\t\tfileExtension: \"\",\n\t\t\timageModal: {},\n\t\t\tconfirmModal: {},\n\t\t\teditorModal: {},\n\t\t\tconfig: {},\n\t\t}\n\t},\n\twatch: {\n\t\tlocale(val) {\n\t\t\tthis.$i18n.locale = val\n\t\t},\n\t},\n\tmethods: {\n\t\teditImage() {\n\t\t\tthis.alertMessage = false\n\t\t\tif (!ALLOWED_FILE_EXTENTIONS.includes(this.fileExtension.toLowerCase())) {\n\t\t\t\tthis.alert = true\n\t\t\t\tthis.alertType = \"error\"\n\t\t\t\tthis.alertMessage = this.$i18n.t(\"not_allowed_extension\")\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\tthis.alert = false\n\t\t\tthis.alertType = false\n\t\t\tthis.alertMessage = false\n\t\t\tthis.open(this.imageURL)\n\t\t},\n\t\topen(url) {\n\t\t\tthis.config.source = url\n\t\t\tthis.imageEditor = new FilerobotImageEditor(\n\t\t\t\tdocument.querySelector(\"#imageEditor\"),\n\t\t\t\t{\n\t\t\t\t\tdefaultToolId: TOOLS.FILTERS,\n\t\t\t\t\tsource: url,\n\t\t\t\t\tlanguage: this.locale,\n\t\t\t\t},\n\t\t\t)\n\t\t\tthis.editorModal.show()\n\n\t\t\tthis.imageEditor.render({\n\t\t\t\tonClose: (closingReason) => {\n\t\t\t\t\tthis.imageEditor.terminate()\n\t\t\t\t\tthis.editorModal.hide()\n\t\t\t\t},\n\t\t\t\tonBeforeSave: (imageFileInfo) => {\n\t\t\t\t\treturn false\n\t\t\t\t},\n\t\t\t\tonSave: (imageData, imageDesignState) => {\n\t\t\t\t\tthis.download(imageData)\n\t\t\t\t\tthis.imageEditor.terminate()\n\t\t\t\t},\n\t\t\t})\n\t\t},\n\t\tdownload({ fullName, mimeType, imageCanvas }) {\n\t\t\tthis.newImage = imageCanvas.toDataURL()\n\t\t\tthis.alert = false\n\t\t\tthis.alertType = false\n\t\t\tthis.alertMessage = false\n\t\t\tthis.imageModal.show()\n\t\t\tthis.editorModal.hide()\n\t\t\treturn false\n\t\t},\n\t\tcloneImage() {\n\t\t\tthis.imageModal.hide()\n\t\t\taxios\n\t\t\t\t.post(\n\t\t\t\t\t\"/admin/cms/media/clone\",\n\t\t\t\t\t{\n\t\t\t\t\t\tid: this.id,\n\t\t\t\t\t\tclone: true,\n\t\t\t\t\t\tprovider: this.provider,\n\t\t\t\t\t\tcontext: this.context,\n\t\t\t\t\t\tfile: this.newImage,\n\t\t\t\t\t},\n\t\t\t\t\taxiosConfig,\n\t\t\t\t)\n\t\t\t\t.then((response) => {\n\t\t\t\t\tthis.alert = true\n\n\t\t\t\t\tif (response.data.success) {\n\t\t\t\t\t\tthis.alertMessage = this.$t(\"message.cloned\", {\n\t\t\t\t\t\t\turl: response.data.url,\n\t\t\t\t\t\t})\n\t\t\t\t\t\tthis.alertType = \"success\"\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.alertMessage = response.data.error\n\t\t\t\t\t\tthis.alertType = \"error\"\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.catch((error) => {\n\t\t\t\t\tconsole.log(error)\n\t\t\t\t})\n\t\t},\n\t\tupdateImage() {\n\t\t\tthis.imageModal.hide()\n\t\t\tthis.confirmModal.show()\n\t\t},\n\t\trejectUpdate() {\n\t\t\tthis.imageModal.show()\n\t\t\tthis.confirmModal.hide()\n\t\t},\n\t\tconfirmUpdate() {\n\t\t\tthis.confirmModal.hide()\n\n\t\t\taxios\n\t\t\t\t.post(\n\t\t\t\t\t\"/admin/cms/media/clone\",\n\t\t\t\t\t{\n\t\t\t\t\t\tid: this.id,\n\t\t\t\t\t\tclone: false,\n\t\t\t\t\t\tprovider: this.provider,\n\t\t\t\t\t\tcontext: this.context,\n\t\t\t\t\t\tfile: this.newImage,\n\t\t\t\t\t},\n\t\t\t\t\taxiosConfig,\n\t\t\t\t)\n\t\t\t\t.then((response) => {\n\t\t\t\t\tif (response.data.success) {\n\t\t\t\t\t\twindow.location.href = response.data.url\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.alert = true\n\t\t\t\t\t\tthis.alertMessage = response.data.error\n\t\t\t\t\t\tthis.alertType = \"error\"\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.catch((error) => {\n\t\t\t\t\tconsole.log(error)\n\t\t\t\t})\n\t\t},\n\t},\n}\n</script>\n"],"names":[],"sourceRoot":""}