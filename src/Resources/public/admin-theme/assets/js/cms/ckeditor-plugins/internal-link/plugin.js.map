{"version":3,"file":"plugin.js","names":["CKEDITOR","plugins","add","lang","requires","on","ev","data","name","setup","JSON","parse","ajax","load","infoTab","definition","getContents","onLoad","linkType","this","getContentElement","internalinkOptions","$","domId","getValue","getElement","show","hide","type","id","children","widths","label","editor","internal_link","locale","style","items","locales","onChange","intern","getDialog","clear","select","pages","forEach","page","url","commit","element","dialog","getCurrent","setValueOf","allowOnChange","setValue","advanced","advLangCode","d"],"sources":["internal-link/plugin.js"],"mappings":"AAAAA,SAASC,QAAQC,IAAI,gBAAiB,CAClCC,KAAM,CAAC,KAAM,MACbC,SAAU,SACVJ,SAASK,GAAG,oBAAoB,SAAUC,GAC1C,GAAqB,SAAjBA,EAAGC,KAAKC,KAAiB,CACzB,IAAIC,EAAQC,KAAKC,MAAMX,SAASY,KAAKC,KAAK,kCACtCC,EAAUR,EAAGC,KAAKQ,WAAWC,YAAY,QAC7CV,EAAGC,KAAKQ,WAAWE,OAAS,WAExB,IAAIC,EAAWC,KAAKC,kBAAmB,OAAQ,YAC3CC,EAAqBF,KAAKC,kBAAmB,OAAQ,sBACzDE,EAAE,IAAIJ,EAASK,OAAOlB,GAAG,UAAU,WACJ,QAAxBa,EAASM,WACRH,EAAmBI,aAAaC,OAEhCL,EAAmBI,aAAaE,MAExC,GACJ,EAEAb,EAAQZ,IAAI,CACR0B,KAAM,OACNC,GAAI,qBACJC,SAAU,CACN,CACIF,KAAM,OAAQG,OAAQ,CAAC,MAAO,OAAQD,SAAU,CAC5C,CACIF,KAAM,SACNC,GAAI,SACJG,MAAO1B,EAAG2B,OAAO9B,KAAK+B,cAAcC,OACpCC,MAAO,aACPC,MAAO5B,EAAM6B,QACbC,SAAU,WACN,IAAIJ,EAAShB,KAAKK,WACdf,EAAQC,KAAKC,MAAMX,SAASY,KAAKC,KAAK,wCAA0CsB,IAChFK,EAASrB,KAAKsB,YAAYrB,kBAAkB,OAAQ,UACxDoB,EAAOE,QACPF,EAAOtC,IAAII,EAAG2B,OAAO9B,KAAK+B,cAAcS,OAAQ,IAEhDlC,EAAMmC,MAAMC,SAAQ,SAAUC,GAC1BN,EAAOtC,IAAI4C,EAAKtC,KAAMsC,EAAKC,IAC/B,GACJ,EACAC,OAAQ,SAAUC,GACNjD,SAASkD,OAAOC,aACtBC,WAAW,WAAY,cAAejC,KAAKK,WACjD,EACAf,MAAO,SAAUF,GACbY,KAAKkC,eAAgB,EACrBlC,KAAKmC,SAAS/C,EAAKgD,SAAWhD,EAAKgD,SAASC,YAAc/C,EAAM6B,QAAQ,GAAG,IAC3EnB,KAAKkC,eAAgB,CACzB,GACD,CACCzB,KAAM,SACNC,GAAI,SACJG,MAAO1B,EAAG2B,OAAO9B,KAAK+B,cAAcA,cACpCE,MAAO,aACPC,MAAO,CAAC,CAAC/B,EAAG2B,OAAO9B,KAAK+B,cAAcS,OAAQ,OAC9CJ,SAAU,WACN,IAAIkB,EAAIzD,SAASkD,OAAOC,aACxBM,EAAEL,WAAW,OAAQ,MAAOjC,KAAKK,YACjCiC,EAAEL,WAAW,OAAQ,WAAajC,KAAKK,WAAyB,GAAZ,UACxD,EACAf,MAAO,SAAUF,GACbY,KAAKkC,eAAgB,EACrBlC,KAAKmC,SAAS/C,EAAKwC,IAAMxC,EAAKwC,IAAIA,IAAM,IACxC5B,KAAKkC,eAAgB,CACzB,OAMjB,aACP,CACJ","sourcesContent":["CKEDITOR.plugins.add(\"internal_link\", {\n    lang: [\"de\", \"en\"],\n    requires: \"ajax\"\n}), CKEDITOR.on('dialogDefinition', function (ev) {\n    if (ev.data.name === 'link') {\n        var setup = JSON.parse(CKEDITOR.ajax.load(\"/cms/pages/internal-url.json?\"));\n        var infoTab = ev.data.definition.getContents('info');\n        ev.data.definition.onLoad = function()\n        {\n            var linkType = this.getContentElement( 'info', 'linkType' );\n            var internalinkOptions = this.getContentElement( 'info', 'internalinkOptions' );\n            $('#'+linkType.domId).on('change', function () {\n                if(linkType.getValue() === 'url'){\n                    internalinkOptions.getElement().show()\n                }else{\n                    internalinkOptions.getElement().hide()\n                }\n            })\n        };\n\n        infoTab.add({\n            type: 'vbox',\n            id: 'internalinkOptions',\n            children: [\n                {\n                    type: \"hbox\", widths: [\"25%\", \"75%\"], children: [\n                        {\n                            type: 'select',\n                            id: 'locale',\n                            label: ev.editor.lang.internal_link.locale,\n                            style: 'width:100%',\n                            items: setup.locales,\n                            onChange: function () {\n                                var locale = this.getValue();\n                                var setup = JSON.parse(CKEDITOR.ajax.load(\"/cms/pages/internal-url.json?_locale=\" + locale));\n                                var intern = this.getDialog().getContentElement(\"info\", \"intern\");\n                                intern.clear();\n                                intern.add(ev.editor.lang.internal_link.select, '');\n\n                                setup.pages.forEach(function (page) {\n                                    intern.add(page.name, page.url);\n                                });\n                            },\n                            commit: function (element) {\n                                var d = CKEDITOR.dialog.getCurrent();\n                                d.setValueOf('advanced', 'advLangCode', this.getValue());\n                            },\n                            setup: function (data) {\n                                this.allowOnChange = false;\n                                this.setValue(data.advanced ? data.advanced.advLangCode : setup.locales[0][1]);\n                                this.allowOnChange = true;\n                            }\n                        }, {\n                            type: 'select',\n                            id: 'intern',\n                            label: ev.editor.lang.internal_link.internal_link,\n                            style: 'width:100%',\n                            items: [[ev.editor.lang.internal_link.select, null]],\n                            onChange: function () {\n                                var d = CKEDITOR.dialog.getCurrent();\n                                d.setValueOf('info', 'url', this.getValue());\n                                d.setValueOf('info', 'protocol', !this.getValue() ? 'http://' : '');\n                            },\n                            setup: function (data) {\n                                this.allowOnChange = false;\n                                this.setValue(data.url ? data.url.url : '');\n                                this.allowOnChange = true;\n                            }\n                        }\n                    ]\n                }\n            ]\n\n        }, 'urlOptions');\n    }\n});"]}